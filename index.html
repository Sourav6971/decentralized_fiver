<html>
	<head>
		<script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@latest/lib/index.iife.min.js"></script>
		<!-- Correct Solana Web3.js CDN -->
	</head>
	<body>
		<button id="connectButton">Connect wallet</button>
	</body>
	<script>
		(async function main() {
			const connectButton = document.getElementById("connectButton");
			connectButton.onclick = async () => {
				const isPhantomInstalled = window.phantom?.solana?.isPhantom;

				if (isPhantomInstalled) {
					const provider = window.phantom.solana;
					try {
						// Connect to Phantom wallet
						const response = await provider.connect();
						console.log("Connected to Phantom:", response.publicKey.toBase58());

						// Set up Solana connection to Devnet
						const connection = new window.solanaWeb3.Connection(
							window.solanaWeb3.clusterApiUrl("devnet")
						);

						// Prepare the transaction
						const transaction = new window.solanaWeb3.Transaction().add(
							window.solanaWeb3.SystemProgram.transfer({
								fromPubkey: response.publicKey, // Use response publicKey here
								toPubkey: new window.solanaWeb3.PublicKey(
									"92cSz3MRiWEgtKhveuFZJgyRmgBJHSbrkiREpu5Vr374" // Replace with recipient address
								),
								lamports: 100, // Amount to send in lamports (1 SOL = 1e9 lamports)
							})
						);

						// Set recent blockhash and fee payer
						const { blockhash } = await connection.getRecentBlockhash();
						transaction.recentBlockhash = blockhash;
						transaction.feePayer = response.publicKey; // Use response publicKey for fee payer

						// Sign and send the transaction via Phantom
						const signedTransaction = await provider.signTransaction(
							transaction
						);
						const signature = await connection.sendRawTransaction(
							signedTransaction.serialize()
						);
						console.log("Transaction Signature:", signature);
					} catch (err) {
						console.error("Error connecting or sending transaction:", err);
					}
				} else {
					alert("Phantom wallet is not installed!");
				}
			};
		})();
	</script>
</html>
